{% extends "base.html" %}{% load i18n %}
{% load material_form %}

{% block content %}
<div class="section">
  <div class="row">
    <div class="col s12 m12 xl12">
      {% csrf_token %}
      <form action="{% url 'archive:performances' %}" method="GET">
        <div class="row">
          <div class="input-field col m9 s8">
            <input name="search" id="search" type="search" value="{{ form.search  }}" >
            <label for="search"><i class="material-icons">search</i></label>
          </div>
          <div class="input-field col m3 s4">
            <button class="btn" type="submit">{% trans "Search" %}</button>
          </div>
        </div>
      </form>
      <div class="row">
        {% for obj in performances %}
        <div class="col xl4 l6 m6 s12">
            <div class="card">
                <div class="card-image waves-effect waves-block waves-light">
                    <div class="video-container">
                      <iframe width="853" height="480" src="https://www.youtube.com/embed/{{obj.youtube_id}}" frameborder="0" allowfullscreen></iframe>
                    </div>
                    <!-- <a href="https://www.youtube.com/watch?v={{obj.youtube_id}}" target="_blank" ><img src="https://img.youtube.com/vi/{{obj.youtube_id}}/0.jpg"></a> -->
                </div>
                <div class="card-content">
                    <span class="card-title activator grey-text text-darken-4">{{obj.track}}<i class="material-icons right">more_vert</i></span>
                    <p><b>{% trans "Pilot" %}: </b>{{obj.pilot}}</p>
                    <p><b>{% trans "Car" %}: </b>{{obj.car}}</p>
                    <p><b>{% trans "Team" %}: </b>{{obj.team}}</p>
                </div>
                {% if user.is_authenticated %}
                <div class="card-action">
                    <a href="{% url 'archive:edit_performance' obj.id %}" >Edit</a>
                    <a href="{% url 'archive:delete_performance' obj.id %}" >Delete</a>
                </div>
                {% endif %}
                <div class="card-reveal">
                    <span class="card-title grey-text text-darken-4">{{obj.track}}<i class="material-icons right">close</i></span>
                    <p><b>Rally: </b>{{obj.rally}}</p>
                    <p><b>{% trans "Car" %}: </b>{{obj.car}}</p>
                    <p><b>{% trans "Pilot" %}: </b>{{obj.pilot}}</p>
                    <p><b>{% trans "Team" %}: </b>{{obj.team}}</p>
                    <p><b>{% trans "Category" %}: </b>{{obj.category}}</p>
                    <p><b>{% trans "Time" %}: </b>{{obj.time}}</p>
                    <p><b>{% trans "Stage (SS)" %}: </b>{{obj.stage_number}}</p>
                    <p><b>{% trans "Note" %}: </b>{{obj.note}}</p>
                    <p><b>{% trans "Uploaded" %}: </b>{{obj.uploaded_at}}</p>
                </div>
            </div>
        </div>
        {% endfor %}
      </div>
   </div>
  </div>
</div>
<script>
$(document).ready(function(){
  $('.datepicker').datepicker({
    format: 'yyyy-mm-dd', 
    autoClose: true, 
    showClearBtn: true
  });
});
</script>
{% endblock content %}